<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FRAME.ARCHIVE</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <style>
        body {
            background-color: black;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }

#cameraViewContainer {
    width: 33vh;
    height: 33vh;
            position: relative;
            overflow: hidden;
            background-color: black;
            z-index: 2;
        }

        #cameraView {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        #startCameraButton {
            user-select: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: black;
            color: white;
            border: none;
            cursor: pointer;
            outline: none;
            opacity: 1;
            transition: opacity 3.3s;
            z-index: 9;
        }

#startCameraButton img {
    width: 222px;
    height: auto;
}


        #startCameraButton:hover {
            opacity: 1;
        }

#MenuButton {
        user-select: none;
-webkit-tap-highlight-color: transparent;
    position: absolute;
    top: 20%;
    left: 18%;
    transform: translate(-50%, -50%);
    background-color: black;
    color: white;
    width: 11px;
    height: 11px;
    font-size: 2.5rem;
    font-family: Arial, Helvetica, sans-serif;
    border-radius: 50%;
    padding: 0;
    border: none;
    cursor: pointer;
    outline: none;
    z-index: 5;
    display: flex;
    justify-content: center;
    align-items: center;
    opacity: 0.3;
    transition: opacity 3s;
}

#MenuButton img {
    width: 44px;
    height: auto;
}


#MenuButton:hover {
    opacity: 0.9;
}

#takePhotoButton {
    user-select: none;
-webkit-tap-highlight-color: transparent;
    position: absolute;
    top: 80%;
    right: 18%;
    transform: translate(+50%, -50%);
    background-color: transparent;
    color: white;
    border: none;
    cursor: pointer;
    outline: none;
    z-index: 5;
    display: flex;
    justify-content: center;
    align-items: center;
    opacity: 0.8;
    transition: opacity 3s;
}

#takePhotoButton img {
    width: 44px;
    height: auto;
}

#takePhotoButton:hover {
    opacity: 0.9;
}

#openTextInputButton {
-webkit-tap-highlight-color: transparent;
    user-select: none;
    position: absolute;
    top: 80%;
    left: 18%;
    transform: translate(-50%, -50%);
    background-color: transparent;
    color: white;
    border: none;
    cursor: pointer;
    z-index: 5;
    display: flex;
    justify-content: center;
    align-items: center;
    opacity: 0;
    transition: opacity 1.1s;
}

#openTextInputButton img {
    width: 44px;
    height: auto;
}

#textInputContainer {
    position: absolute;
    bottom: 40%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: rgba(255, 255, 255, 0);
    width: 78%;
    height: 200px;
    display: none;
    z-index: 8;
}

#roundedTextInput {
    display: flex;
    align-items: center;
}

#textInput {
    flex-grow: 1;
    border: none;
    border-radius: 22px;
    padding: 11px;
text-align: center;
}

#nodesShareButton {
-webkit-tap-highlight-color: transparent;
    user-select: none;
    position: absolute;
    top: 20%;
    right: 18%;
    transform: translate(+50%, -50%);
    background-color: transparent;
    color: white;
    border: none;
    cursor: pointer;
    outline: none;
    z-index: 8;
    opacity: 0;
    transition: opacity 1.1s;
}

#nodesShareButton img {
    width: 44px;
    height: auto;
}

        #tokenCountDisplay {
            font-family: Arial, sans-serif;
            font-size: 0.8rem;
            color: white;
            position: absolute;
            top: calc(20% - 28px);
            left: calc(18% + 15px);
            opacity: 0;
    transition: opacity 1.1s;
        }

    </style>

</head>

<body>

    <div id="tokenCountDisplay"></div>

    <button id="nodesShareButton">
        <img src="share.png">
    </button>

    <div id="textInputContainer" style="display: none;">
        <div id="roundedTextInput">
            <input type="text" id="textInput" placeholder="Enter a link..." value="" autocapitalize="none">
        </div>
    </div>

    <button id="openTextInputButton" style="pointer-events: none;">
        <img src="plus.png">
    </button>

    <div id="cameraViewContainer">
        <video id="cameraView" autoplay></video>
    </div>

    <button id="startCameraButton" onclick="toggleFullscreen()">
        <img src="presplash.jpg">
    </button>

    <button id="MenuButton" onclick="toggleMenu()">
        <img src="frame.png">
    </button>

    <button id="takePhotoButton">
        <img src="capture.png">
    </button>

    <canvas id="photoCanvas" style="display: none;"></canvas>

</body>

    <script>

        var TOKEN_COUNT = 11;
        var tokenCountDisplay = document.getElementById("tokenCountDisplay");
        tokenCountDisplay.textContent = TOKEN_COUNT;

const openTextInputButton = document.getElementById('openTextInputButton');
const textInputContainer = document.getElementById('textInputContainer');
const textInput = document.getElementById('textInput');

let SAVED_LINK = '';

openTextInputButton.addEventListener('click', () => {
    openTextInputButton.style.opacity = 0.7;
    textInputContainer.style.display = 'block';
    textInput.focus();
    textInput.placeholder = SAVED_LINK;
});

textInput.addEventListener('keydown', (event) => {
    if (event.key === 'Enter' || event.key === 'Go') {
        SAVED_LINK = textInput.value;
        textInputContainer.style.display = 'none';
        textInput.value = ''; 
        console.log('SAVED_LINK:', SAVED_LINK);
updateOpenButtonOpacity();
    }
});

function updateOpenButtonOpacity() {
    if (SAVED_LINK && SAVED_LINK.trim() !== '') {
        openTextInputButton.style.opacity = '0.9';
    } else {
        openTextInputButton.style.opacity = '0.2';
    }
}

        const cameraView = document.getElementById('cameraView');
        const startCameraButton = document.getElementById('startCameraButton');
        const takePhotoButton = document.getElementById('takePhotoButton');
        const photoCanvas = document.getElementById('photoCanvas');
        const canvasContext = photoCanvas.getContext('2d');
        let stream;

async function startCamera() {
    try {
        const constraints = {
            video: {
                facingMode: 'environment',
            },
            audio: false,
        };

        stream = await navigator.mediaDevices.getUserMedia(constraints);
        cameraView.srcObject = stream;
        startCameraButton.disabled = true;
        takePhotoButton.disabled = false;
        startCameraButton.style.opacity = '0';
        startCameraButton.style.pointerEvents = 'none';
    } catch (error) {
        console.error('Error accessing the camera:', error);
    }
}

        function takePhoto() {
            if (stream) {
                cameraView.pause();
                photoCanvas.width = cameraView.videoWidth;
                photoCanvas.height = cameraView.videoHeight;
                canvasContext.drawImage(cameraView, 0, 0, photoCanvas.width, photoCanvas.height);
                const photoDataUrl = photoCanvas.toDataURL('image/jpeg');
                console.log('Photo taken:', photoDataUrl);
                cameraView.play();
            }
        }

        startCameraButton.addEventListener('click', () => {
            startCamera();
        });

        function toggleFullscreen() {
            const docElement = document.documentElement;

            if (docElement.requestFullscreen) {
                if (document.fullscreenElement) {
                    document.exitFullscreen();
                } else {
                    docElement.requestFullscreen().catch(err => {
                        console.error('Error attempting to enable fullscreen:', err);
                    });
                }
            }
        }

        window.addEventListener('DOMContentLoaded', () => {
            takePhotoButton.addEventListener('click', takePhoto);
        });

var MENUVAR = 0

function toggleMenu() {
MENUVAR = (MENUVAR === 0) ? 1 : 0;

    var openTextInputButton = document.getElementById('openTextInputButton');
    var nodesShareButton = document.getElementById('nodesShareButton');
    var tokenCountDisplay = document.getElementById('tokenCountDisplay');
    var menuButton = document.getElementById('MenuButton');

    if (MENUVAR === 1) {
        menuButton.style.opacity = '0.8';
        nodesShareButton.style.opacity = '0.3';
        nodesShareButton.style.pointerEvents = 'auto';
        openTextInputButton.style.opacity = '0.3';
        openTextInputButton.style.pointerEvents = 'auto';
        tokenCountDisplay.style.opacity = '0.7';
    } else {
        menuButton.style.opacity = '0.3';
        nodesShareButton.style.opacity = '0';
        nodesShareButton.style.pointerEvents = 'none';
        tokenCountDisplay.style.opacity = '0';
        openTextInputButton.style.opacity = '0';
        openTextInputButton.style.pointerEvents = 'none';
        textInputContainer.style.display = 'none';
        SAVED_LINK = '';
    }
}

    </script>
</body>
</html>
